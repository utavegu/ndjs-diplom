# Описание проекта и варианты его запуска

Проект представляет собой серверную часть веб-приложения для просмотра и бронирования отелей. Выполнен на фреймворке **Nest.js** версии **9.1.8**.

Для запуска проекта в системе должны быть установлены docker и docker compose. Разработка приложения велась на **Docker** версии **23.0.4** и **Docker Compose** версии **2.12.2**. Версия используемой **node** - **18.12.0**, **npm** - **8.19.3**.

Сначала в корне проекта нужно создать файл **.env** и скопировать туда содержимое **.env-example**, заменив значения на нужные. Далее нужно запустить сборку с помощью Докера.

Для продакшн-сборки используйте команду **docker-compose -f docker-compose.prod.yml up**, а сборку для разработки можно запустить командой **docker-compose -f docker-compose.dev.yml up** (нужно находиться в директории проекта).

## Несколько инструкций для тестирования

### Краткая инструкция для тестирования websocket-ов через Postman
  1) My Workspace
  2) New
  3) WebSocket Request
  4) Raw поменять на Socket.IO (если это Socket.IO)
  5) ws://localhost:***ВНЕШНИЙ_ПОРТ_ПРИЛОЖЕНИЯ***/
  6) Connect
  7) Запонлнить Event Name
  8) формат JSON
  9) Пример: { "text": "Сообщение" }
  10) В Listeners добавить имена событий, которые слушает клиент
  11) Send

  Есть еще протокол wss.
  Не забывать делать дисконнект, если менялись переменные окружения.


### Тестирование загрузки файлов через Postman в приложении Nest.js

Для загрузки нескольких файлов с помощью Multer через Postman выбираем Post -> Body -> form-data (это multipart-formdata). В столбце key пишем то, что указано в @UseInterceptors(FilesInterceptor('***')), а в столбце value - выбираем путь до файла. При мульти-загрузке файлов значение key во всех строках будет одно и то же, а в value - разные пути до файла. Если параллельно нужно будет передать body, то эти поля по тому же принципу пишутся в следующих строках. Только это будет малтипарт-формдата, потому... (нюансы работы с ней)

### Тестирование аутентификации через Postman
Если токен передается в заголовках, варианта 2:
1) Напрямую добавить заголовок запроса Authorication - Bearer *.*.* (где *.*.* - JWT-токен, полученный после успешного логина)
2) Выбрать вкладку Authorization. Type - Bearer Token. И туда вставить токен, полученный из Response после успешного логина.

В данном случае аутентификация выполнена через JWT-токен и cookies. Потому ничего дополнительно в постмане делать не нужно, он сам их сохранит между вкладками. Но для понимания их можно проверить или удалить вручную с помощью Cookies под кнопкой Send.



### Наставления тестировщику (мне, для написания тестов на Jest, на будущее).
Обрабатывать разные кейсы:
- емэйл занят, не существует
- не хватает обязательных полей
- есть лишние поля
- значения не валидны
- ...

В идеале сделать dump для моментального заполнения БД.
